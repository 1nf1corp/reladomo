<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Frequently Asked Questions</title><link href="mithradoc.css" type="text/css" rel="stylesheet"><meta content="DocBook XSL Stylesheets V1.79.1" name="generator"><!-- (c) 2016 Copyright Goldman Sachs, Inc. --></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article"><div class="titlepage"><div><div><h2 class="title"><a name="N40003"></a>Frequently Asked Questions</h2></div></div><hr></div>

    

    <div class="qandaset"><a name="N40011"></a><dl><dt>Q: <a href="#N40014">When should I use a reverse relationship?</a></dt><dt>Q: <a href="#N40049">How do I define a many-to-many relationship that's realized via a third table?
                </a></dt><dt>Q: <a href="#N40069">Why does Reladomo generate a "between" clause when using an "in" clause?</a></dt><dt>Q: <a href="#N40089">Can I use inheritance when two objects have very similar set of
                    attributes?</a></dt><dt>Q: <a href="#N400BD">How do I update an object?</a></dt><dt>Q: <a href="#N400D6">How can I generate a primary key before inserting?</a></dt><dt>Q: <a href="#N400F2">Do I have to put every column in the Reladomo XML?</a></dt><dt>Q: <a href="#N40111">Does Reladomo cache results?</a></dt><dt>Q: <a href="#N40131">Does Reladomo support math operations and other SQL functions?</a></dt><dt>Q: <a href="#N40162">What are the initial values of nullable primitives?</a></dt><dt>Q: <a href="#N4017E">What cacheType should I use?</a></dt><dt>Q: <a href="#N4019A">If I start a transaction, then create a new Reladomo object and call insert on
                    it. But before committing this transaction, I try to do a lookup for the just
                    created Reladomo object using a Finder's find method; would I get the newly
                    created and inserted object back? </a></dt><dt>Q: <a href="#N401B3"> What's echo 2 used for?</a></dt><dt>Q: <a href="#N401CC"> What value do I have to choose for the business date of a newly created
                    object before inserting it?</a></dt><dt>Q: <a href="#N401E8">What value do I have to choose for the processing date for a newly created
                    object before inserting it?</a></dt><dt>Q: <a href="#N40204">What happens if I set some values on a dated object and terminate it in the
                    same transaction?</a></dt><dt>Q: <a href="#N40220">How do I join across two tables in two different databases? E.g.
                    ReportedTraderPnl and Account.</a></dt><dt>Q: <a href="#N4025B">How do I get dated objects for all dates?</a></dt><dt>Q: <a href="#N402BF">When does Reladomo use "distinct" in the generated SQL?</a></dt><dt>Q: <a href="#N402F5">I need to do some raw JDBC queries before I get to the Reladomo objects and
                    start working with them. Is there a way for me to get a DB connection from the
                    MithraManager so I don't have to create my own connection for the raw JDBC
                    stuff?</a></dt><dt>Q: <a href="#N40318">I need to guarantee that the connection manager that I am using for my plain
                    JDBC is the same as that used by Reladomo. I would like to avoid having to mention
                    the connection manager class name twice - once in the Reladomo configuration XML
                    file and once again in the code where plain JDBC stuff is done. We have several
                    connection manager classes and it is possible to refer to 2 different connection
                    manager classes in the 2 locations by mistake.</a></dt><dt>Q: <a href="#N4033B">When we do a select all rows from Reladomo, it seems that Reladomo actually tries
                    to load the whole table into memory at the first access to the loaded MithraList
                    object. Is there a way to tune Reladomo so that it will only try to load the table
                    in chunks? </a></dt><dt>Q: <a href="#N40360">If we use cacheType="partial" then does that allow for the data rows to be
                    changed (say by replication) and the cache to be refreshed dynamically? Here is
                    the scenario: </a></dt><dt>Q: <a href="#N403B1">If I am mostly doing Reladomo lookups on data that can change via replication
                    but I am doing these lookups in transactions, then do I get any benefit from
                    setting cacheType="partial" over cacheType="none"? Seems like in this case your
                    partial cache might degenerate to none cache or how else can it guarantee to
                    provide the new data. </a></dt><dt>Q: <a href="#N403CD">Is isProcessingDate="true" a mandatory attribute for "processingDate"?</a></dt><dt>Q: <a href="#N403E9">How do Keys and Relationships work in Reladomo? How do you find things?</a></dt><dt>Q: <a href="#N40418">What is reverseRelationship for?</a></dt><dt>Q: <a href="#N40449">What's the life cycle of a Reladomo object?</a></dt><dt>Q: <a href="#N40484">How do you set up caching options for each class?</a></dt><dt>Q: <a href="#N404A0">Can I pass parameters to a relationship getter?</a></dt><dt>Q: <a href="#N404DC">How do I debug Reladomo generated sql?</a></dt><dt>Q: <a href="#N40507">How can I tell what I can use in the xml for my Reladomo-enabled class?</a></dt><dt>Q: <a href="#N4052A">How do you create many to many relationships utilizing a join table?</a></dt><dt>Q: <a href="#N4055D">Which Reladomo files do I check into my VCS (Version Control System)?</a></dt><dt>Q: <a href="#N40597">If I retrieve a Reladomo object (from the DB) and then proceed to do the
                    following, what will happen?</a></dt><dt>Q: <a href="#N405D3">Does Reladomo have support for schemas?</a></dt><dt>Q: <a href="#N405F2">I have to do a query to select "distinct accounts" from a Reladomo table. I am
                    pasting some code below to show you what I am doing so you can tell me if I
                    should desist from doing similar stuff or if there is a better way to do
                    this:</a></dt><dt>Q: <a href="#N4061B">Why would a Reladomo Finder return the same Reladomo object over and over again in
                    a Reladomo list?</a></dt><dt>Q: <a href="#N40647">Is there a way to have the returned list sorted by a particular attribute (the
                    equivalent of "order by" in SQL)? </a></dt><dt>Q: <a href="#N40664">Why can't I order by the processing date?</a></dt><dt>Q: <a href="#N40680">What does the SourceAttribute tag in the Reladomo XML mean?</a></dt><dt>Q: <a href="#N4069C">Can I have a single Reladomo object mapped to a table that resides in multiple
                    databases?</a></dt><dt>Q: <a href="#N406DD">Are the following 2 lines of code effectively equivalent (given that I am
                    using JDK 1.5)?</a></dt><dt>Q: <a href="#N40707">Why do my generated Reladomo classes not have an insert() method?</a></dt><dt>Q: <a href="#N4072A">What is the proper way to get everything from a database table if we are using
                    Reladomo? In other words, how do you translate a relational query having no where
                    clause to a Reladomo query? </a></dt><dt>Q: <a href="#N40744">We are looking to use Reladomo in some of our feed processing flows. We
                    currently have a ETL library (built in house) called ODIN that can insert input
                    data (from any source) into DB tables. It doesn't do any milestoning though so
                    we need to use Reladomo. Thus, our processing flow would look something like the
                    following: </a></dt><dt>Q: <a href="#N4078C">How can I get a handle to the Reladomo DB connection manager in my client code
                    so I can set its connection attribute? </a></dt><dt>Q: <a href="#N407BB">Is there any way to configure Reladomo such that it will accept FROM_Z and
                    THRU_Z columns with column type "date" in the database (instead of datetime)?
                </a></dt><dt>Q: <a href="#N407D7">Is there a published XML schema for Reladomo (or even better, a sample XML
                    document that includes all elements with comments to explain which are mandatory
                    / optional and what they are for)? </a></dt><dt>Q: <a href="#N407F3">What does the following tag means?</a></dt><dt>Q: <a href="#N4081F">What does the superclassType attribute in the MithraObject tag mean?</a></dt><dt>Q: <a href="#N4083B">How does table-for-all-subclasses work?</a></dt><dt>Q: <a href="#N40875">A Model has a list of account IDs for which it is Observable, but we don't
                    want to have relationships with account, since model is living in a different
                    database. Instead, we just want to persist account IDs as Strings. So the table
                    for them would be model ID - account ID. And Model would have method List
                    getObservableAccountIds() </a></dt><dt>Q: <a href="#N40892">How can I enable timezone conversion in Reladomo?</a></dt><dt>Q: <a href="#N408B4">How do I handle timezone conversion using Reladomo?</a></dt><dt>Q: <a href="#N408EF">How can I do Reladomo and non-Reladomo database operations in the same
                    transaction?</a></dt><dt>Q: <a href="#N40912">Is there a Gradle plug-in for various Reladomo build tasks (generate code, graphs, etc)?</a></dt><dt>Q: <a href="#N40935">Is there a Maven plug-in to generate the Reladomo classes / DDL / GraphML-model?</a></dt><dt>Q: <a href="#N40958">Is there a Maven plug-in to reverse-engineer Reladomo object XML files from an existing database schema?</a></dt><dt>Q: <a href="#N4097B">How can I work with Stored Procedures in Reladomo?</a></dt><dt>Q: <a href="#N409DB">Why does setMaxObjectsToRetrieve() sometimes work, and sometimes doesn't?</a></dt><dt>Q: <a href="#N409F4">Can you bulk-insert to a table with nullable columns
                    if those columns are not mapped in Reladomo?</a></dt><dt>Q: <a href="#N40A10">Why can't we bulk-insert varchar columns bigger than 256?</a></dt><dt>Q: <a href="#N40A29">What schema spaces can Reladomo use to create temporary tables?
                The runtime uses an application ID that is part of DACT_RW</a></dt><dt>Q: <a href="#N40A4E">I have multiple JVMs running Reladomo and accessing the same database, some reading,
                      some writing, and some doing both.  How do I keep the caches up-to-date?</a></dt><dt>Q: <a href="#N40A88">I have set up a notification server -- how do I get transparency into what is happening?</a></dt><dt>Q: <a href="#N40AAB">Where can I get training for Reladomo?</a></dt><dt>Q: <a href="#N40AC7">How can I test if my deep-fetch is working?</a></dt><dt>Q: <a href="#N40AE7">What connection manager should I use?</a></dt><dt>Q: <a href="#N40B1E">Is there a way that I can use Spring framework for transaction management?</a></dt><dt>Q: <a href="#N40B40">How do I "restore" a previous version of a audit-only dated object?</a></dt><dt>Q: <a href="#N40B60">How do I perform a case-insensitive search of a column? Should I use wildCardEq()?</a></dt><dt>Q: <a href="#N40B7D">I am using DB2 and performance seems poor, particularly of prepared statements,
                    and we don't think the indexes are being used. What's the problem?</a></dt><dt>Q: <a href="#N40BA6">Why does Reladomo use IntHashSet instead of Set&lt;Integer&gt;?</a></dt><dt>Q: <a href="#N40BD5">Which repos can I get Reladomo from?</a></dt><dt>Q: <a href="#N40BF4">How can I tell if Reladomo's queries match up to the indexes I have declared on my database tables?</a></dt><dt>Q: <a href="#N40C20">How can I verify if the Reladomo xmls which I wrote match up the database table definitions?</a></dt><dt>Q: <a href="#N40C6D">What's the best way to update a set of existing data based on a new incoming set of detached data?</a></dt><dt>Q: <a href="#N40C96">Does Reladomo support result-set paging?</a></dt><dt>Q: <a href="#N40CB4">Does Reladomo support Views?</a></dt><dt>Q: <a href="#N40CD0">Text fields / How can I store long text values using Reladomo?</a></dt><dt>Q: <a href="#N40CE9">Do I have any control for clearing objects that Reladomo has cached?</a></dt><dt>Q: <a href="#N40D1D">What's the difference between delete(), terminate(), and purge()?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%"><col></colgroup><tbody>
            
            <tr class="question"><td valign="top" align="left"><a name="N40014"></a><a name="N40023"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>When should I use a reverse relationship?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>It's optional</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>It should never be put on both sides: the whole point of it is to
                            avoid repeating yourself.</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>If it's a dependency relationship (e.g. order to order item), then on
                            the parent side makes more sense to me. If it's not a dependency
                            relationship (e.g. user to group), then I don't know of a good rule of
                            thumb.</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>A relationship with a parameter can't have a reverse
                            relationship.</p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40049"></a><a name="N40058"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I define a many-to-many relationship that's realized via a third table?
                </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>You need the third class, but after you create the xml for it, you can
                    reference it in your many- to-many relationship. Here is an example from
                    Reladomo's User.xml (used for testing):</p><pre class="programlisting">
<strong xmlns:xslthl="http://xslthl.sf.net" style="color: navy" class="hl-tag">&lt;Relationship</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"groups"</span> <span style="color: blue" class="hl-attribute">relatedObject</span>=<span style="color: green" class="hl-value">"Group"</span> <span style="color: blue" class="hl-attribute">orderBy</span>=<span style="color: green" class="hl-value">"name DESC"</span>
          <span style="color: blue" class="hl-attribute">cardinality</span>=<span style="color: green" class="hl-value">"many-to-many"</span> <span style="color: blue" class="hl-attribute">reverseRelationshipName</span>=<span style="color: green" class="hl-value">"users"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
 UserGroup.ownerId = this.id and Group.id = UserGroup.dependentId
<strong style="color: navy" class="hl-tag">&lt;/Relationship&gt;</strong>     </pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40069"></a><a name="N40078"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Why does Reladomo generate a "between" clause when using an "in" clause?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>There is usually a performance benefit for Sybase: the proper index will get
                    picked up. In rare cases, it is actually bad. It can be turned off, like
                    so:</p><pre class="programlisting">
Operation op = FooFinder.someAttribute().in(set);
<strong class="hl-keyword"><span style="color: #000080">if</span></strong> (op <strong class="hl-keyword"><span style="color: #000080">instanceof</span></strong> InOperation)
{
    InOperation in = (InOperation) op;
    in.setUseBetweenClause(false);
}</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40089"></a><a name="N40098"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Can I use inheritance when two objects have very similar set of
                    attributes?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>We've dealt with this type of situation using inheritance. We have an abstract
                    XML that defines all the columns and two tiny xml files that are the concrete
                    subtypes. To see an example, have a look at: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
                        <p>InventoryItem.xml</p>
                    </li><li class="listitem">
                        <p>Book.xml</p>
                    </li><li class="listitem">
                        <p>Phone.xml</p>
                    </li></ul></div><p>From an object perspective, that's a reasonable approach as well. It's
                    conceivable that these two objects would have different behavior (e.g. one can
                    be reprocessed, but the other cannot). </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N400BD"></a><a name="N400C9"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I update an object?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>There is no update method. Calling setter methods writes to the database. Put
                    several setters in a transaction if you intend them to be a single unit of work.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N400D6"></a><a name="N400E5"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I generate a primary key before inserting?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p> You can assign it before insertion by using the method:
                    generateAndSet&lt;attribute name&gt;() If you have not called that method,
                    it will automatically be called when calling insert().</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N400F2"></a><a name="N40104"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Do I have to put every column in the Reladomo XML?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>You can define only the attributes you need. Caveat: you will not be able to
                    write that object if those attributes are not nullable.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40111"></a><a name="N4011D"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Does Reladomo cache results?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Yes, Reladomo will cache its results using soft references if you specify "partial"
                    as the cacheType in the Object XML.
                    If you know you must go to the database, you can:
                </p><pre class="programlisting">
FooList list = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> FooList(someOp);
list.setBypassCache(true);</pre><p>If you're using Finder.findOne, there is also:
                    Finder.findOneBypassCache
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40131"></a><a name="N40143"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Does Reladomo support math operations and other SQL functions?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>There is very limited support for just a couple of functions:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
                        <p>Double attributes: absoluteValue, plus, minus, times, dividedBy.</p>
                    </li><li class="listitem">
                        <p>String attributes: startsWith, endsWith, contains, wildCard* (these translate to
                            "like"); toLowerCase</p>
                    </li></ul></div><p>Other than that, there is no support for functions in Reladomo right now. Please
                    note that calling SQL functions usually means the data is not correctly
                    normalized (first rule:all column values must be atomic). Databases also hate
                    these queries because there is typically no way to use an index. If there are no
                    other clauses, the query will almost certainly require a full table scan.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40162"></a><a name="N40171"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What are the initial values of nullable primitives?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Java rules apply here. Think of it this way: you're creating a Java object
                    (not a row in a table). So integers will be zero, booleans will be false, etc.
                    There is a convenience method to set all nullable primitives to null. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4017E"></a><a name="N4018D"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What cacheType should I use?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>cacheType="partial" is by far the best choice for almost any situation. Use
                    cacheType="full" for tiny static tables. cacheType="full" is not supported for
                    dated objects. Reladomo guarantees that in a transaction the cache is updated
                    properly. You will never see a stale object in a transaction. I would advise
                    against using cacheType="none". The "none" option should be reserved for rare
                    cases where updates to the tables in questions are completely out of your control.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4019A"></a><a name="N401A6"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>If I start a transaction, then create a new Reladomo object and call insert on
                    it. But before committing this transaction, I try to do a lookup for the just
                    created Reladomo object using a Finder's find method; would I get the newly
                    created and inserted object back? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Yes, Reladomo will flush the transaction if it has to ensure proper
                    results.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N401B3"></a><a name="N401BF"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p> What's echo 2 used for?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The Echo 2 libraries are used in the Reladomo middle tier UI as a temporary
                    measure before we unify the Controllers Technology UI framework. Once the new
                    Controllers Technology framework is available, we'll convert our existing web
                    based UI's (control panel, dashboard, etc). The Echo 2 libraries are not meant
                    to be used for any other purpose. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N401CC"></a><a name="N401DB"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p> What value do I have to choose for the business date of a newly created
                    object before inserting it?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The business date for which you want that object to start it's life. The
                    object will be valid from that business date to infinity. Reladomo will
                    automatically set the FROM and THRU values. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N401E8"></a><a name="N401F7"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What value do I have to choose for the processing date for a newly created
                    object before inserting it?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Infinity. For the processing date dimension, only objects with infinity
                    processing dates may be inserted (or modified). </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40204"></a><a name="N40213"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What happens if I set some values on a dated object and terminate it in the
                    same transaction?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>In a single transaction, it makes no sense to set a value and then terminate.
                    The atomic unit of work makes it so that only the termination happens.
                    And no, it can't be implemented by inserting a row and immediately chaining out
                    because it'll cause an index failure for good reason
                    (the operation makes no sense). </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40220"></a><a name="N4022F"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I join across two tables in two different databases? E.g.
                    ReportedTraderPnl and Account.</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p> If this was all in the same database, you'd simply add a relationship from
                    ReportedTraderPnl to Account and do: </p><pre class="programlisting">
ReportedTraderPnlFinder.account().type().eq(<strong class="hl-string"><span style="color: green">"XYZ"</span></strong>)
</pre><p>The above operation would then join the two tables. However, these are not in
                    the same database, so you cannot do it like that. You'll have to do the join
                    manually. </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>Select the TAMS accounts that have the set of interesting accounts and
                            that type: </p><pre class="programlisting">
TamsAccountList accountList = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> TamsAccountList(TamsAccountFinder.type().eq(<strong class="hl-string"><span style="color: green">"XYZ"</span></strong>));
</pre><p>
                        </p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>do the join: </p><pre class="programlisting">
ReportedTradePnlList pnlList =
<strong class="hl-keyword"><span style="color: #000080">new</span></strong> ReportedTraderPnlList(ReportedTraderPnlFinder.accountId().in(accountList, TamsAccountFinder.accountId()));
</pre><p>
                        </p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4025B"></a><a name="N4026A"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I get dated objects for all dates?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>There is an as of attribute operation that is used to get one object per row
                    in the database: </p><pre class="programlisting">
FooFinder.businessDate().equalsEdgePoint()
             </pre><p>This special operation returns one object per row in the database (not one per
                    milestone). </p><p>If you use this operation, Reladomo will not add the milestone information that
                    it would normally add to the SQL it generates (e.g. 't1.OUT_Z = '9999-12-01
                    23:59:00.000'). This means that you can specify the exact dates you want to
                    retrieve objects for, rather than getting a single object using the AS OF
                    date.</p><p>You then can add extra conditions, such as</p><pre class="programlisting">
FooFinder.businessDateFrom().lessThan(date)
FooFinder.businessDateTo().greaterThanEquals(date)
</pre><p>Here is an example of using equalsEdgePoint to get all the objects between 2
                    dates : </p><pre class="programlisting">
Operation op = FooFinder.businessDate().equalsEdgePoint();
<strong class="hl-keyword"><span style="color: #000080">if</span></strong> (endDate != infinity)
{
	op = op.and(FooFinder.businessDateFrom().lessThanEquals(endDate);
}
op = op.and(FooFinder.businessDateTo().greaterThanEquals(startDate));
FooList foos = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> FooList(op);
</pre><p> foos will have all the foos between the dates. You can play with the equality
                    signs (or the dates) to have open or closed ranges. </p><p>The exists() operation can be used in a similar way: </p><pre class="programlisting">
ProductList list = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> ProductList(ProductFinder.scrpCode().eq(<strong class="hl-string"><span style="color: green">"ABC"</span></strong>).and(ProductFinder.currencySynonym().exists());
</pre><p>In plain English, this says: find products that have an SCRP code of "ABC"
                    which also have at least one currency synonym exists.</p><p>Please note that for a x-to-one relationship, exists is the same as "has at
                    least one", and that's how it should be interpreted for an x-to-many
                    relationship. For example, Product has a one-to-many relationship to
                    TipsIndexRatio. </p><p>The operation: </p><pre class="programlisting">
ProductFinder.tipsIndexRatios().exists()
</pre><p>is interpreted as: products that have at least one tipsIndexRatio.</p><p>It's because Reladomo guarantees that a persistent object (one that came from
                    the database) exists as a single instance in the VM. In other words == is the
                    same as equals.</p><p>But those objects are not "equal". They follow different sets of rules: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>the persistent object will write to the database when a set method is
                            called. It can deleted, but not inserted.</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>the non-persistent object will not write to the database when a set
                            method is called. It can be inserted, but not deleted.</p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N402BF"></a><a name="N402CE"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>When does Reladomo use "distinct" in the generated SQL?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>All the following must be true for Reladomo to issue distinct:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>There is join (via a relationship)</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>The related table is accessed via a set of attributes that does not
                            imply distinctness.</p>
                    </li></ul></div><p>For example, if you have an order with a collection of orderItems
                    (Order.orderId = OrderItem.orderId), then the following operation requires a
                    distinct: </p><pre class="programlisting">
OrderFinder.orderItems().status().eq(<strong class="hl-string"><span style="color: green">"not shipped"</span></strong>) <em style="color: gray" class="hl-comment">// find all orders that have at least one unshipped order item</em>
</pre><p>We use distinct here because the join to order items is via the orderId,
                    which is not a unique identifier for order item. If we don't use distinct, we'll
                    get the same order repeated if it has multiple unshipped items.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N402F5"></a><a name="N40304"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>I need to do some raw JDBC queries before I get to the Reladomo objects and
                    start working with them. Is there a way for me to get a DB connection from the
                    MithraManager so I don't have to create my own connection for the raw JDBC
                    stuff?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The connection manager is your object, so feel free to call the
                    getConnection() method on it. Be 100% sure to return the connection back to the
                    pool. In general, you want your code to always look like: </p><pre class="programlisting">
Connection con = null;
<strong class="hl-keyword"><span style="color: #000080">try</span></strong>
{
    con = connectionManager.getConnection();
    <em style="color: gray" class="hl-comment">// do some stuff</em>
}
<strong class="hl-keyword"><span style="color: #000080">finally</span></strong>
{
    <strong class="hl-keyword"><span style="color: #000080">if</span></strong> (con != null)
    {
        con.close();
    }
}</pre><p>Note: This code is not 3-tier safe.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40318"></a><a name="N40324"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>I need to guarantee that the connection manager that I am using for my plain
                    JDBC is the same as that used by Reladomo. I would like to avoid having to mention
                    the connection manager class name twice - once in the Reladomo configuration XML
                    file and once again in the code where plain JDBC stuff is done. We have several
                    connection manager classes and it is possible to refer to 2 different connection
                    manager classes in the 2 locations by mistake.</p><p>Is there a way where I can simply ask Reladomo to give me a reference to its
                    connection manager? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Every database object keeps a reference to the connection manager. You can get
                    it via: </p><pre class="programlisting">
FooFinder.getMithraObjectPortal().getDatabaseObject().getConnectionManager()</pre><p>Please note that this code is not 3-tier safe.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4033B"></a><a name="N4034D"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>When we do a select all rows from Reladomo, it seems that Reladomo actually tries
                    to load the whole table into memory at the first access to the loaded MithraList
                    object. Is there a way to tune Reladomo so that it will only try to load the table
                    in chunks? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>There is no real way to do chunks, but you can specify the maximum number of
                    rows to get using the setMaxObjectsToRetrieve method on the list. </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Moh to verify this answer: Yes, by using the list method forEachWithCursor().
                    Do not access the list any other way, or the entire list will be forced into
                    memory all at once. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40360"></a><a name="N4036F"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>If we use cacheType="partial" then does that allow for the data rows to be
                    changed (say by replication) and the cache to be refreshed dynamically? Here is
                    the scenario: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>We read a few rows from a replicated Account table using Reladomo (with
                            cacheType="partial").</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Replication causes some of those rows to change.</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>We try to read some of the rows in #1 (within the same process as #1)
                            using Reladomo.</p>
                    </li></ul></div></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>If you're in a transaction, you're guaranteed to get the new data, as long as
                    the object has been marked as "transactional". Read only objects are not
                    refreshed in a transaction. If you're not in a transaction, and the data is in
                    cache, you have several choices: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>You can clear the cache using
                            AmHubAccountFinder.clearQueryCache().</p>
                        <p>Or</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>You can set a single query to bypass the cache, using either
                            findOneBypassCache, or constructing a list and using
                            setBypassCache(true).</p>
                        <p>Or</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Use cacheType="none" and take a serious speed hit.</p>
                    </li></ul></div><p>For objects that are under your control (like the one I helped debug), partial
                    cache is definitely better. If you setup Reladomo's notification feature separate
                    processes that are using Reladomo to write to the database will notify each other
                    of changes, so none of the above will be required. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N403B1"></a><a name="N403C0"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>If I am mostly doing Reladomo lookups on data that can change via replication
                    but I am doing these lookups in transactions, then do I get any benefit from
                    setting cacheType="partial" over cacheType="none"? Seems like in this case your
                    partial cache might degenerate to none cache or how else can it guarantee to
                    provide the new data. </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The difference between cacheType="partial" and cacheType="none", is that with
                    a partial cache, Reladomo will not have to re-read the same object over and over
                    again in the same transaction; once in a transaction is enough. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N403CD"></a><a name="N403DC"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is isProcessingDate="true" a mandatory attribute for "processingDate"?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p> Reladomo tries to guess that using the attribute name, but you should specify
                    it to be 100% sure.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N403E9"></a><a name="N403F8"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do Keys and Relationships work in Reladomo? How do you find things?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p> There are two things in Reladomo that catch people off guard, because, frankly,
                    they are somewhat unusual: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>Reladomo is a key-less architecture; that is, there are no key objects.
                            Of course, each object is identified by a primary key (which can be as
                            complex as you like), but there is no encapsulation of the primary key
                            into an object of its own. This immediately raises several questions:
                            How do you find anything? The answer is finders. How do you cache and
                            index? The answer is using TObjectHashStrategy. Reladomo defines a cache
                            as a collection of indices. Indices are not maps, they are actually sets
                            that have two extra properties: they are constructed using a hash
                            strategy; they have an extra get method. (Java sets, curiously, have no
                            get method. The only way to access any object using a regular java set
                            is via iteration, which makes it unsuitable for lookups.) Many people
                            seem to have a difficult time understanding this. </p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Reladomo relationships are not pointer based. For example, an order
                            object does not keep a list of order item objects. Of course, the order
                            object still has a getOrderItems() method. To put it differently, the
                            object graph is not physically connected, but the relationships are
                            still present. Relationships are always dynamically resolved via
                            finders. Is this fast enough? Yes, most of the time. There is one
                            situation where we know where it's too slow and we may implement
                            pointer-based relationships at some point in the future. The particular
                            situation arises when a collection of objects is sorted by an attribute
                            of a related object. So for example, if an adjustment history list is
                            being sorted by it's product's description, the getProduct() method gets
                            called O(nLog n) times, which can be very large. For a list of 15000
                            items, the get method is called around 400,000 times. Even though the
                            get method only takes a few micro (1 millionth) of a second, it's still
                            about 100x slower returning a pointer. </p>
                        <p>There are two things in Reladomo that make pointers-less relationships
                            possible: finders and the query cache. Reladomo finders are object
                            oriented. The usability advantages there are obvious, but there is a
                            serious performance benefit as well: no parsing is required to evaluate
                            an operation. The query cache is a map of Reladomo operations to
                            previously found results. The operation knows what it depends on so the
                            query cache can cleverly expire things out of cache. </p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40418"></a><a name="N40427"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What is reverseRelationship for?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>This element in the Relationship clause of the Reladomo object XML is an
                    optional item, which can be used to indicate which side is the 'boss' of the
                    relationship, and so that the backwards relationship and the forewaqrds
                    relationship are both declared in one place. Note the following: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
                        <p>if it's a dependency relationship (e.g. order to order item), then on
                            the parent (order) side makes more sense. If it's not a dependency
                            relationship (e.g. user to group), then there is no good rule of thumb
                            (maybe don't use it, instead do one - way relationships on each side)
                        </p>
                    </li><li class="listitem">
                        <p>reverseRelationship should never be put on both sides: the whole point
                            of it is to avoid repeating yourself </p>
                    </li><li class="listitem">
                        <p>a relationship with a parameter can't have a reverse
                            relationship</p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40449"></a><a name="N40455"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What's the life cycle of a Reladomo object?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Currently, Reladomo objects have a very simple life cycle. Everything is
                    explicitly inserted or deleted via calling insert() or delete() respectively.
                    This works out fairly well in the scenario below (where a Strategy has many
                    StrategyPositions): The code looks like:</p><pre class="programlisting">
StrategyPosition sp = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> StrategyPosition();
sp.setX(x);
sp.setY(y);
sp.insert();</pre><p>This is a little ugly, because you have to manually do things like
                    sp.setStrategyId(strategy.getId()); It's not the end of the world, but I think
                    we can do better. Note that you only have to set the primitive attributes and
                    all relationships work automagically as described above. In a very real sense,
                    Reladomo is a thinner layer over the database (at least at the moment) than object
                    manager. </p><p>The next time you call strategy.getStrategyPositions(), the query cache knows
                    that the previous answer is no longer valid (because a new strategy position has
                    been inserted) and will take appropriate action to re-resolve that operation. If
                    everything is cached and indexed (as happens in the Object Manager), this is a
                    quick, all in-memory operation. If not, we'll hit the database (or 2nd tier
                    cache). For 50,000 that could be pretty expensive. I have all sorts of ideas
                    about how to make that better, but not a real plan yet. One approach would be to
                    mark certain queries as expensive (e.g. the result is very large) and try to
                    massage the result as relevant events happen (insert, update, delete). </p><p>BTW, delete works the same way (there is just no need to construct and
                    populate the object). So the following code works: </p><pre class="programlisting">
Strategy s;
StrategyPosition sp = s.getStrategyPositions().get(<span style="color:blue" class="hl-number">0</span>);
sp.delete();</pre><p>Calling s.getStrategyPositions() will return a list that no longer contains
                    the deleted element. If you keep a reference to the list that had the strategy
                    position in it, it will not be removed from that list. </p><p>In the long run, we want to make certain life cycle handling more closely
                    aligned with the way object manager handles things, which is nicer in many ways,
                    especially because it's closer to Java's understanding of an object's life
                    cycle. Specifically, we want to be able to have the following methods do the
                    right thing: </p><p>
                    <span class="bold"><strong>strategy.getStrategyPositions().add(x)</strong></span>:
                    equivalent to insert, but also sets the relevant fields to ensure consistency
                    (e.g. strategyId) prior to insert<span class="bold"><strong>strategy.getStrategyPositions().remove(x)</strong></span>: equivalent to delete
                    The implementation of these methods also creates a fast path for updating our
                    query cache. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40484"></a><a name="N40493"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do you set up caching options for each class?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Reladomo requires a xml runtime configuration file. See the xsd for possible values.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N404A0"></a><a name="N404AC"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Can I pass parameters to a relationship getter?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>We can declare parameterized relationships in the xml and deep fetch them as
                    well. A parameterized relationship takes parameters. It's declared in the xml
                    like so (from Order.xml): </p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;Relationship</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"itemForProduct"</span>
          <span style="color: blue" class="hl-attribute">relatedObject</span>=<span style="color: green" class="hl-value">"OrderItem"</span>
          <span style="color: blue" class="hl-attribute">cardinality</span>=<span style="color: green" class="hl-value">"one-to-one"</span>
          <span style="color: blue" class="hl-attribute">parameters</span>=<span style="color: green" class="hl-value">"int productId"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
 OrderItem.orderId = this.orderId and OrderItem.productId = {productId}
<strong style="color: navy" class="hl-tag">&lt;/Relationship&gt;</strong></pre><p>There can be multiple parameters (E.g. parameters="Timestamp asOfDate, String
                    foo, int bar"). Note the curly braces. This is a new addition: you can use curly
                    braces for arbitrary java snippets of code, as well as parameters. The values
                    within the curly braces must be a constant. For example, you can do: </p><pre class="programlisting">
{com.example.foo.Bar.SOME_CONSTANT} or {Math.sin(<span style="color:blue" class="hl-number">1.4</span>)+<span style="color:blue" class="hl-number">17</span>}</pre><p>Note: if your relationship specification uses greater-than or less-than
                    operations, you need to enclose the text in a CDATA section: </p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;![CDATA[</strong>
... and EodAcctIfPnl.processingDateFrom &gt; {checkpoint}
<strong style="color: navy" class="hl-tag">]]&gt;</strong></pre><p>The above relationship generates a method on Order that looks like</p><pre class="programlisting"><strong class="hl-keyword"><span style="color: #000080">public</span></strong> OrderItem getItemForProduct(<strong class="hl-keyword"><span style="color: #000080">int</span></strong> productId)</pre><p>To deep fetch this relationship, you can:</p><pre class="programlisting">
OrderList list = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> OrderList(...);
list.deepFetch(OrderFinder.itemForProduct(<span style="color:blue" class="hl-number">12</span>));</pre><p>So now, list.getOrderAt(0).getItemForProduct(12) will no longer hit the
                    database. This can be used in many places, notably the dated details of product.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N404DC"></a><a name="N404EB"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I debug Reladomo generated sql?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Add a line to your log4j configuration:</p><p>log4j.logger.com.gs.fw.common.mithra.sqllogs=DEBUG</p><p>for batched statements, you will need:</p><p>log4j.logger.com.gs.fw.common.mithra.batch.sqllogs=DEBUG</p><p>Warning: SQL logging is very expensive in terms of runtime performance.
                    Do not turn these options on unless absolutely necessary.</p><p>Note: If you have an 'old' version of Log4J, you may need to change the '.logger.' for '.category.'.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40507"></a><a name="N40516"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I tell what I can use in the xml for my Reladomo-enabled class?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Look at the XML schema : mithraobject.xsd The Reladomo test
                    code provides good examples, it is in the source tree at reladomo/test/src
                    Also, copy and paste from other classes! </p><p>By providing a reference to the XSD, IDEs can usually help out by providing
                    "code assist" type help. Consider adding a reference to the mithraobject.xsd
                    to the MithraObject element:</p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;MithraObject</strong> <span style="color: blue" class="hl-attribute">objectType</span>=<span style="color: green" class="hl-value">"transactional"</span>
              <span style="color: blue" class="hl-attribute">xmlns:xsi</span>=<span style="color: green" class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
              <span style="color: blue" class="hl-attribute">xsi:noNamespaceSchemaLocation</span>=<span style="color: green" class="hl-value">"mithraobject.xsd"</span><strong style="color: navy" class="hl-tag">&gt;</strong></pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4052A"></a><a name="N40539"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do you create many to many relationships utilizing a join table?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>This is an example:</p><p>Table RISK_POINT has a primary key of RISK_POINT.OBJECT_ID. Table DIMENSION
                    has a primary key of DIMENSION.OBJECT_ID. Join table RISK_POINT_DIMENSION has
                    columns of RISK_POINT_OID and DIMENSION_OID, and is used to relate RiskPoint to
                    Dimension. </p><p>There is a many-to-many relationship between risk points and dimensions. This
                    is what you do: </p><p>Create a Reladomo XML file for each table, e.g. RiskPoint.xml,
                    RiskPointDimension.xml, Dimension.xml. In RiskPointDimension specify 2
                    attributes - riskPointId that uses RISK_POINT_OID, and dimensionId that uses
                    DIMENSION_OID.</p><p>Then in RiskPoint.xml you can specify:</p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;Relationship</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"dimensions"</span> <span style="color: blue" class="hl-attribute">relatedObject</span>=<span style="color: green" class="hl-value">"Dimension"</span> <span style="color: blue" class="hl-attribute">cardinality</span>=<span style="color: green" class="hl-value">"many-to-many"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
RiskPointDimension.riskPointId = this.id and Dimension.id = RiskPointDimension.dimensionId
<strong style="color: navy" class="hl-tag">&lt;/Relationship&gt;</strong></pre><p>And in Dimension.xml you can specify:</p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;Relationship</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"riskPoints"</span> <span style="color: blue" class="hl-attribute">relatedObject</span>=<span style="color: green" class="hl-value">"RiskPoint"</span> <span style="color: blue" class="hl-attribute">cardinality</span>=<span style="color: green" class="hl-value">"many-to-many"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
RiskPointDimension.dimensionId = this.id and RiskPoint.id = RiskPointDimension.riskPointId
<strong style="color: navy" class="hl-tag">&lt;/Relationship&gt;</strong></pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4055D"></a><a name="N40572"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Which Reladomo files do I check into my VCS (Version Control System)?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The first time Reladomo generates code for a new class, it will also generate 3
                    (initially empty) concrete classes: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
                        <p>
                            
                            &lt;MithraClassName&gt;.java
                            
                        </p>
                    </li><li class="listitem">
                        <p>
                            
                            &lt;MithraClassName&gt;DatabaseObject.java
                            
                        </p>
                    </li><li class="listitem">
                        <p>
                            
                            &lt;MithraClassName&gt;List.java
                            
                        </p>
                    </li></ul></div><p>All 3 files should be checked into a VCS even if you do not make any changes to
                    them. As a rule of thumb, the Reladomo generated files in the src directory needs
                    to be checked into a VCS, while those generated in the generatedsrc directory do
                    not have to be checked into a VCS. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40597"></a><a name="N405A6"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>If I retrieve a Reladomo object (from the DB) and then proceed to do the
                    following, what will happen?</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>I set some of the attributes of the object to the same values that
                            they already contain.</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>I set some of the attributes of the object first to null and then back
                            to their original values (within the same transaction).</p>
                    </li></ul></div><p>Will Reladomo recognize that no material change has happened to the object in
                    both cases?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Case 1 is easy: no change will be done to the object or the database.</p><p>For case 2, there is really no way for Reladomo to detect that. In fact,
                    theoretically, it should not be optimized. Consider the following sequence in a
                    transaction: </p><pre class="programlisting">
someObj = findSomeObjectByPrimaryKey();
someObj.setSomeAttr(null);
someObjList = findAllObjectsWithAttrNull();</pre><p>The last step depends on the change in the second step. Reladomo detects this
                    and issues the update before doing the last find. </p><p>Reladomo does delay database operations as much as possible (to get better
                    performance through batching), but only as long as the results can be guaranteed
                    to be correct. Case #2 would be quite difficult to implement. I suggest you
                    implement it in your code. One way to do it would be to get a temporary copy of
                    the object, make *all* your changes and then set the values on the persistent
                    (non-temporary) object. Reladomo objects have the following method that might
                    help: getNonPersistentCopy() </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N405D3"></a><a name="N405E2"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Does Reladomo have support for schemas?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Schemas can be declared in the runtime configuration. That way, it's easier to
                    deploy into various environments (qa, prod, etc) where the schema names may not
                    be the same. </p><p>See MithraConfigPartialCache.xml for an example.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N405F2"></a><a name="N40604"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>I have to do a query to select "distinct accounts" from a Reladomo table. I am
                    pasting some code below to show you what I am doing so you can tell me if I
                    should desist from doing similar stuff or if there is a better way to do
                    this:</p><pre class="programlisting">
List marketMakerAccountsList =
   PrimeEntityProductRoleFinder.getMithraObjectPortal().computeFunction (PrimeEntityProductRoleFinder.role().eq(<strong class="hl-string"><span style="color: green">"MM"</span></strong>),
                                     null,
                                     <strong class="hl-string"><span style="color: green">"distinct "</span></strong> + PrimeEntityProductRoleFinder.entityAccountNumber().getColumnName(),
                                     <strong class="hl-keyword"><span style="color: #000080">new</span></strong> StringResultSetParser());
</pre><p>Here "StringResultSetParser" is my own class built on the pattern of
                    "IntegerResultSetParser".</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>We would discourage this kind of use. You can still get distinct accounts if
                    you have a relationship from Prime entity product role to an account object: </p><p>AccountFinder.primeEntityProductRole().role().eq("MM")</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4061B"></a><a name="N4062A"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Why would a Reladomo Finder return the same Reladomo object over and over again in
                    a Reladomo list?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>This problem stems from a bad primary key. The easiest way to ensure this
                    doesn't happen is to make sure:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: a; "><li class="listitem" style="list-style-type: a">
                        <p>The table has a unique index</p>
                    </li><li class="listitem" style="list-style-type: a">
                        <p>The same columns in the unique index are declared with
                            primaryKey="true" in the Reladomo XML</p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40647"></a><a name="N40653"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is there a way to have the returned list sorted by a particular attribute (the
                    equivalent of "order by" in SQL)? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><pre class="programlisting">
FooList list = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> FooList(someOperation);
list.setOrderBy(FooFinder.someAttribute().ascendingOrderBy().
and(FooFinder.someOtherAttribute().descendingOrderBy()));
</pre><p>You can even specify order by in a relationship declaration.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40664"></a><a name="N40673"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Why can't I order by the processing date?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Processing date is a virtual attribute and it's typically the same for all
                    objects in the query. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40680"></a><a name="N4068F"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What does the SourceAttribute tag in the Reladomo XML mean?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>A SourceAttribute is a logical attribute (that is, it's not persisted
                    anywhere) that corresponds to the location of actual storage. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4069C"></a><a name="N406AB"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Can I have a single Reladomo object mapped to a table that resides in multiple
                    databases?</p><p>Do I need to put the same class under 2 different DB connection managers
                    within the MithraConfiguration.xml file? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>No, Reladomo has the ability to handle objects of the same type stored in tables
                    residing in different databases. This is supported via the SourceAttribute tag. </p><p>Here are the steps to take:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>Add a &lt;SourceAttribute&gt; tag to the xml. Two types of
                            source attributes are supported: string and int. Use string for now.
                        </p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Create a connection manager that implements
                            ObjectSourceConnectionManager. The getConnection method now takes a
                            parameter, which is the source attribute of the object in question.
                            Based on this parameter, you should give out one connection or the
                            other. </p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>All find operations must specify the source attribute as an extra
                            operation.</p>
                        <p>E.g.
                            ProductFinder.source().eq("firstDb").and(ProductFinder.cusip().eq("1234"))</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>You must set the source attribute on an object before
                            inserting.</p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N406DD"></a><a name="N406EC"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Are the following 2 lines of code effectively equivalent (given that I am
                    using JDK 1.5)?</p><pre class="programlisting">
MyMithraClassList myObjectList = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> MyMithraClassList(MyMithraClassFinder.all());

List&lt;MyMithraClass&gt; myObjectList = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> MyMithraClassList(MyMithraClassFinder.all());
</pre></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>No, they are not. The second form is just a genericised List, which doesn't
                    have any of the Reladomo methods (e.g. insertAll(), relationship getters,
                    deepFetch, etc) </p><pre class="programlisting">
MithraList&lt;MyMithraClass&gt; myObjectList = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> MyMithraClassList(...);
</pre><p>Is a little bit better, as you get some common methods (deepFetch, setOrderBy,
                    etc), but it still is not as good as the specific class, which has methods
                    specific to that object (e.g. relationship getters) </p><p>As a rule-of-thumb, use the specific list-class generated by Reladomo for you,
                    so that you always have access to all the appropriate Reladomo methods.
                    The List&lt;T&gt; allows the MithraList to work fairly seamlessly with most
                    libraries with genericised methods, including GS Collections.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40707"></a><a name="N40716"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Why do my generated Reladomo classes not have an insert() method?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>By default, a Reladomo object is read-only and methods for insert, update, or
                    delete are not generated. If you wish to generate a transactional object (a
                    Reladomo object that can be inserted, updated, or deleted) then you have to define
                    it explicitly in the Reladomo xml using the objectType attribute in the
                    MithraObject tag. </p><p>Example:</p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;MithraObject</strong> <span style="color: blue" class="hl-attribute">objectType</span>=<span style="color: green" class="hl-value">"transactional"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4072A"></a><a name="N40736"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What is the proper way to get everything from a database table if we are using
                    Reladomo? In other words, how do you translate a relational query having no where
                    clause to a Reladomo query? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><pre class="programlisting">FooList fooList = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> FooList(FooFinder.all())</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40744"></a><a name="N40750"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>We are looking to use Reladomo in some of our feed processing flows. We
                    currently have a ETL library (built in house) called ODIN that can insert input
                    data (from any source) into DB tables. It doesn't do any milestoning though so
                    we need to use Reladomo. Thus, our processing flow would look something like the
                    following: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>Use ODIN to process records input data records into memory</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Pass the "in-memory record" to an adapter that will convert it to the
                            appropriate Reladomo class (that maps to the correct DB table) </p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Use Reladomo to insert into the database.</p>
                    </li></ul></div><p>The complication in this scenario is that the input data records reside in a
                    staging table in a database. Happily, Reladomo is supposed to write its output to
                    the same database albeit to a different table. We want to share the DB
                    connection between ODIN and Reladomo in this scenario. We know that ODIN can not
                    accept a DB connection from outside. Can Reladomo be handed a DB connection to
                    use? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The short answer is: yes, you can hand the connection in. However, doing so
                    is a little tricky. The good news is, the connection manager is a runtime
                    configuration, so you won't have to make any changes to your Reladomo objects
                    themselves. But you will have to write a custom connection manager for this
                    purpose. </p><p>Here is what you need to do:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>Create a connection manager class that can be initialized with a
                            connection (e.g. the one that comes from ODIN). </p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>the getConnection() method will not return the plain ODIN connection,
                            but a simple wrapper connection around it. The wrapper delegates all
                            methods to the ODIN connection, except for close(). Reladomo expects the
                            close() method to return the connection back to the pool. So the close
                            method in the wrapper connection would be empty. </p>
                    </li></ul></div><p>In the long run, it would be good to have our entire infrastructure (OBJ,
                    ODIN, etc) understand the concept of a connection pool. That way, different
                    parts of our infrastructure can "play nice" and share the same connection by the
                    virtue of having the same connection manager. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4078C"></a><a name="N40798"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I get a handle to the Reladomo DB connection manager in my client code
                    so I can set its connection attribute? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>That's up to you. You control the connection manager. A singleton pattern
                    works well in these situations. </p><p>When Reladomo reads the configuration xml file, it does the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>call the static method "getInstance()" on the configured connection
                            manager</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>instantiate the database objects for all configured objects and set
                            the connection manager (that was gotten in 1) on the database object
                        </p>
                    </li></ul></div><p>To get a reference to the connection manager, you should therefore call the
                    same getInstance() method. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N407BB"></a><a name="N407CA"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is there any way to configure Reladomo such that it will accept FROM_Z and
                    THRU_Z columns with column type "date" in the database (instead of datetime)?
                </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>That's not possible with the current code and it would be a significant
                    departure from the current architecture. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N407D7"></a><a name="N407E3"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is there a published XML schema for Reladomo (or even better, a sample XML
                    document that includes all elements with comments to explain which are mandatory
                    / optional and what they are for)? </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>mithraobject.xsd is the schema definition for the MithraObject xml.</p><p>It is well documented and it does define mandatory and possible values. In
                    addition, there is documentation on the mithraobject.xsd
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N407F3"></a><a name="N407FF"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What does the following tag means?</p><p>&lt;SuperClass name = "AbstractParaTransaction" generated="true"/&gt; </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>It means two things:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>There is an "AbstractParaTransaction.xml" that defines
                            AbstractParaTransaction</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>This class extends AbstractParaTransaction and therefore inherits
                            everything in it. Subclasses have an option to override attribute and
                            relationship definitions in a compatible way. </p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4081F"></a><a name="N4082B"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What does the superclassType attribute in the MithraObject tag mean?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>An object's super class type can be "table-per-subclass" or
                    "table-for-all-subclasses". For table-per-subclass objects, all the attributes
                    of the object must appear in each table. </p><p>For table-for-all-subclasses, all objects live in the same table are
                    differentiated typically by some attribute. It is up to the implementation to
                    override the database object's createObject method. </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4083B"></a><a name="N40847"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How does table-for-all-subclasses work?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Table for all subclasses works like this:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>Add superClassType="table-for-all-subclasses" to the object definition</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Create (in your IDE) subclasses of the concrete class.
                            For example, if you have a class called Trade and you want two subclasses,
                            SecurityTrade and ContractualTrade, you create those two file like any normal java class,
                            subclassing Trade.</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>After regenerating the code, there will be a new abstract method in the abstract
                            database object that you must implement in your concrete database object.
                            It'll look like this:</p>
                    </li></ul></div><pre class="programlisting">
<strong class="hl-keyword"><span style="color: #000080">protected</span></strong> Trade constructTrade(MithraDataObject data)
</pre><p>Typically, you'd implement the method along the lines of:</p><pre class="programlisting">
TradeData tradeData = (TradeData) data;
<strong class="hl-keyword"><span style="color: #000080">if</span></strong> (tradeData.getType().equals(&ldquo;SEC&rdquo;)) <em style="color: gray" class="hl-comment">// this can be any condition based on the data for this object</em>
{
    <strong class="hl-keyword"><span style="color: #000080">return</span></strong> <strong class="hl-keyword"><span style="color: #000080">new</span></strong> SecurityTrade();
}
<strong class="hl-keyword"><span style="color: #000080">else</span></strong> <strong class="hl-keyword"><span style="color: #000080">if</span></strong> (tradeData.getType().equals(&ldquo;CON&rdquo;))
{
    <strong class="hl-keyword"><span style="color: #000080">return</span></strong> <strong class="hl-keyword"><span style="color: #000080">new</span></strong> ContractualTrade();
}
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40875"></a><a name="N40881"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>A Model has a list of account IDs for which it is Observable, but we don't
                    want to have relationships with account, since model is living in a different
                    database. Instead, we just want to persist account IDs as Strings. So the table
                    for them would be model ID - account ID. And Model would have method List
                    getObservableAccountIds() </p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>If I understand this correctly, you have an object called Model that
                    corresponds to a MODEL table and another object called ModelAccount that
                    corresponds to MODEL_ACCOUNT table (with just model id, account id in it). There
                    is a natural relationship between these two objects: model.getModelAccounts()
                    would return a list of ModelAccount objects. If you want just the account ID's,
                    you'll have to write a trivial loop: </p><pre class="programlisting">
<strong class="hl-keyword"><span style="color: #000080">public</span></strong> List getObservableAccountIds()
{
    List result = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> ArrayList();
    <strong class="hl-keyword"><span style="color: #000080">for</span></strong>(Iterator it = <strong class="hl-keyword"><span style="color: #000080">this</span></strong>.getModelAccounts().iterator(); it.hasNext(); )
    {
        result.add(it.next().getAccountId());
    }
    <strong class="hl-keyword"><span style="color: #000080">return</span></strong> result;
}
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40892"></a><a name="N408A1"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I enable timezone conversion in Reladomo?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>You can enable UTC time for a timestamp or AsOf attribute by adding:
                    timezoneConversion="convert-to-utc" or
                    timezoneConversion="convert-to-database-timezone" to the attribute declaration. </p><p>The date will be stored as UTC in the database. I suggest you put UTC in the
                    column name to avoid confusion (e.g. IN_UTC, OUT_UTC). The conversion is done at
                    points of entry and exit into the VM. The infinity date is treated specially: it
                    must be created in the VM's local timezone and Reladomo will take care not to
                    convert it. This allows using the same infinity date for both business and
                    processing dates. There is no need to do manual conversions for querying,
                    inserts, updates or deletes. </p><p> Please don't create relationships between different types of dates. It will
                    break.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N408B4"></a><a name="N408C3"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I handle timezone conversion using Reladomo?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Select the right conversion type in the xml definition. From then on, don't
                    worry about it and imagine you live in one timezone. </p><p>Under the covers, this is what happens:</p><pre class="programlisting">
now = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> Timestamp(System.currentTimeMillis());  <em style="color: gray" class="hl-comment">// e.g. 2005-10-10 1:05 pm EST</em>
</pre><p>Like all java dates, this is internally stored as a long, which is in
                    UTC</p><pre class="programlisting">
checkpoint.setTimestamp(now)
</pre><p>Nothing interesting happens in the VM at this point. When we create the SQL
                    statement, we make sure we do: </p><pre class="programlisting">
update CHECKPOINT set TIMESTAMP=<strong class="hl-string"><span style="color: green">'2005-10-10 6:05 pm'</span></strong>
</pre><p>The thing to understand about the database is that you can't issue the
                    statement:</p><pre class="programlisting">
update CHECKPOINT set TIMESTAMP=<strong class="hl-string"><span style="color: green">'2005-10-10 6:05 pm UTC'</span></strong>
</pre><p>Because the database never stored timezones. That's why I recommend you put
                    "UTC" in the column name.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N408EF"></a><a name="N408FE"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I do Reladomo and non-Reladomo database operations in the same
                    transaction?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>You can do it. You need to flush the Reladomo transaction using the method
                    executeBufferedOperations(). </p><p>Here is an example :</p><pre class="programlisting">
MithraManager.getInstance().executeTransactionalCommand(<strong class="hl-keyword"><span style="color: #000080">new</span></strong> TransactionalCommand() {

    <strong class="hl-keyword"><span style="color: #000080">public</span></strong> Object executeTransaction(MithraTransaction mithraTransaction) <strong class="hl-keyword"><span style="color: #000080">throws</span></strong> Throwable {

        harsha.setFirstName(newName);
        mithraTransaction.executeBufferedOperations();  <em style="color: gray" class="hl-comment">// required to flush the Reladomo transaction</em>

        Connection conn = null;

        <strong class="hl-keyword"><span style="color: #000080">try</span></strong>
        {
            conn = ((ObjectSourceConnectionManager)
            	EmployeeFinder.getMithraObjectPortal().getDatabaseObject().
            	getConnectionManager()).getConnection(<strong class="hl-string"><span style="color: green">"NYC"</span></strong>);
            CallableStatement cstmt = conn.prepareCall(
            <strong class="hl-string"><span style="color: green">" { call pri_tne_employee_card (?,?,?,?) } "</span></strong>);

            cstmt.setString(<span style="color:blue" class="hl-number">1</span>, <strong class="hl-string"><span style="color: green">"123456789"</span></strong>);
            cstmt.setString(<span style="color:blue" class="hl-number">2</span>, harsha.getEmployeeId());
            cstmt.setString(<span style="color:blue" class="hl-number">3</span>, <strong class="hl-string"><span style="color: green">"AMXBAN"</span></strong>);
            cstmt.setString(<span style="color:blue" class="hl-number">4</span>, <strong class="hl-string"><span style="color: green">"10-Jan-2008"</span></strong>);

            cstmt.execute();
        }
        <strong class="hl-keyword"><span style="color: #000080">finally</span></strong>
        {
            <strong class="hl-keyword"><span style="color: #000080">if</span></strong>(conn != null) conn.close();
        }

        <strong class="hl-keyword"><span style="color: #000080">return</span></strong> null;
    }
});</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40912"></a><a name="N40921"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is there a Gradle plug-in for various Reladomo build tasks (generate code, graphs, etc)?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>No. Gradle supports ant tasks natively; use Reladomo's ant tasks directly in gradle.</p><p>For example :</p><pre class="programlisting">
apply plugin: <strong class="hl-string"><span style="color: green">'java'</span></strong>

<em style="color: gray" class="hl-comment">// Make sure apply plugin: 'java' is present</em>
configurations {
  mithraGenConfig
}

dependencies {
mithraGenConfig <strong class="hl-string"><span style="color: green">"com.gs.mithra:mithra:${versions.mithra}"</span></strong>
  mithraGenConfig <strong class="hl-string"><span style="color: green">"com.gs.mithra:mithragen:${versions.mithra}"</span></strong>
}

task mithraGenerateSources&lt;&lt; {
  ant.taskdef(name: <strong class="hl-string"><span style="color: green">'mithraGen'</span></strong>,
          classname:<strong class="hl-string"><span style="color: green">'com.gs.fw.common.mithra.generator.MithraGenerator'</span></strong>,
          loaderRef: <strong class="hl-string"><span style="color: green">'mithraGenerator'</span></strong>,
          classpath: configurations.mithraGenConfig.asPath,
  )

  ant.mithraGen(
          xml:<strong class="hl-string"><span style="color: green">'src/main/resources/Mithra/database/MithraClassList.xml'</span></strong>,
          generatedDir:<strong class="hl-string"><span style="color: green">'generated/java'</span></strong>,
          nonGeneratedDir:<strong class="hl-string"><span style="color: green">'src/main/java'</span></strong>,
          generateConcreteClasses:<strong class="hl-string"><span style="color: green">'true'</span></strong>,
          generateGscListMethod:<strong class="hl-string"><span style="color: green">'true'</span></strong>
  )
}

task mithraClean {
  delete <strong class="hl-string"><span style="color: green">'generated/java'</span></strong>
}

clean.dependsOn(mithraClean)

build.dependsOn(mithraGenerateSources)

compileJava.dependsOn mithraGenerateSources
sourceSets {
  main {
    java {
      srcDir <strong class="hl-string"><span style="color: green">'generated/java'</span></strong>
    }
  }
}</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40935"></a><a name="N40944"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is there a Maven plug-in to generate the Reladomo classes / DDL / GraphML-model?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>No. Use the Maven Antrun plugin instead.</p><p>Here is an example:</p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;properties&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mithra-version&gt;</strong>15.4.2<strong style="color: navy" class="hl-tag">&lt;/mithra-version&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/properties&gt;</strong>

<strong style="color: navy" class="hl-tag">&lt;dependencies&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;dependency&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;groupId&gt;</strong>com.gs.mithra<strong style="color: navy" class="hl-tag">&lt;/groupId&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;artifactId&gt;</strong>mithra<strong style="color: navy" class="hl-tag">&lt;/artifactId&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;version&gt;</strong>${mithra.version}<strong style="color: navy" class="hl-tag">&lt;/version&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/dependency&gt;</strong>

    <strong style="color: navy" class="hl-tag">&lt;dependency&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;groupId&gt;</strong>com.gs.mithra<strong style="color: navy" class="hl-tag">&lt;/groupId&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;artifactId&gt;</strong>mithragen<strong style="color: navy" class="hl-tag">&lt;/artifactId&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;version&gt;</strong>${mithra.version}<strong style="color: navy" class="hl-tag">&lt;/version&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/dependency&gt;</strong>

    <strong style="color: navy" class="hl-tag">&lt;dependency&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;groupId&gt;</strong>com.gs.mithra<strong style="color: navy" class="hl-tag">&lt;/groupId&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;artifactId&gt;</strong>mithragendb<strong style="color: navy" class="hl-tag">&lt;/artifactId&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;version&gt;</strong>${mithra.version}<strong style="color: navy" class="hl-tag">&lt;/version&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;scope&gt;</strong>compile<strong style="color: navy" class="hl-tag">&lt;/scope&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/dependency&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/dependencies&gt;</strong>

<strong style="color: navy" class="hl-tag">&lt;plugin&gt;</strong>
   <strong style="color: navy" class="hl-tag">&lt;groupId&gt;</strong>org.apache.maven.plugins<strong style="color: navy" class="hl-tag">&lt;/groupId&gt;</strong>
   <strong style="color: navy" class="hl-tag">&lt;artifactId&gt;</strong>maven-antrun-plugin<strong style="color: navy" class="hl-tag">&lt;/artifactId&gt;</strong>
   <strong style="color: navy" class="hl-tag">&lt;executions&gt;</strong>
       <strong style="color: navy" class="hl-tag">&lt;execution&gt;</strong>
           <strong style="color: navy" class="hl-tag">&lt;id&gt;</strong>generateMithra<strong style="color: navy" class="hl-tag">&lt;/id&gt;</strong>
           <strong style="color: navy" class="hl-tag">&lt;phase&gt;</strong>generate-sources<strong style="color: navy" class="hl-tag">&lt;/phase&gt;</strong>
           <strong style="color: navy" class="hl-tag">&lt;goals&gt;</strong>
               <strong style="color: navy" class="hl-tag">&lt;goal&gt;</strong>run<strong style="color: navy" class="hl-tag">&lt;/goal&gt;</strong>
           <strong style="color: navy" class="hl-tag">&lt;/goals&gt;</strong>
           <strong style="color: navy" class="hl-tag">&lt;configuration&gt;</strong>
               <strong style="color: navy" class="hl-tag">&lt;tasks&gt;</strong>
                   <strong style="color: navy" class="hl-tag">&lt;echo&gt;</strong>Start of Reladomo code generation<strong style="color: navy" class="hl-tag">&lt;/echo&gt;</strong>
                   <strong style="color: navy" class="hl-tag">&lt;taskdef</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"mithra-gen"</span>
                            <span style="color: blue" class="hl-attribute">classname</span>=<span style="color: green" class="hl-value">"com.gs.fw.common.mithra.generator.MithraGenerator"</span>
                            <span style="color: blue" class="hl-attribute">loaderRef</span>=<span style="color: green" class="hl-value">"mithraGenerator"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
                       <strong style="color: navy" class="hl-tag">&lt;classpath</strong> <span style="color: blue" class="hl-attribute">refid</span>=<span style="color: green" class="hl-value">"maven.compile.classpath"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
                   <strong style="color: navy" class="hl-tag">&lt;/taskdef&gt;</strong>
                   <strong style="color: navy" class="hl-tag">&lt;mithra-gen</strong> <span style="color: blue" class="hl-attribute">xml</span>=<span style="color: green" class="hl-value">"${basedir}/src/main/resources/path-to-your-mithra-xml-files/FullMithraClassList.xml"</span>
                               <span style="color: blue" class="hl-attribute">generatedDir</span>=<span style="color: green" class="hl-value">"${basedir}/target/mithra/generated/src/main/java"</span>
                               <span style="color: blue" class="hl-attribute">nonGeneratedDir</span>=<span style="color: green" class="hl-value">"${basedir}/src/main/java"</span>
                               <span style="color: blue" class="hl-attribute">generateConcreteClasses</span>=<span style="color: green" class="hl-value">"true"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
                   <strong style="color: navy" class="hl-tag">&lt;/mithra-gen&gt;</strong>
               <strong style="color: navy" class="hl-tag">&lt;/tasks&gt;</strong>
               <strong style="color: navy" class="hl-tag">&lt;echo&gt;</strong>End of Reladomo code generation<strong style="color: navy" class="hl-tag">&lt;/echo&gt;</strong>
           <strong style="color: navy" class="hl-tag">&lt;/configuration&gt;</strong>
       <strong style="color: navy" class="hl-tag">&lt;/execution&gt;</strong>
   <strong style="color: navy" class="hl-tag">&lt;/executions&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/plugin&gt;</strong>

<strong style="color: navy" class="hl-tag">&lt;plugin&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;groupId&gt;</strong>org.codehaus.mojo<strong style="color: navy" class="hl-tag">&lt;/groupId&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;artifactId&gt;</strong>build-helper-maven-plugin<strong style="color: navy" class="hl-tag">&lt;/artifactId&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;executions&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;execution&gt;</strong>
            <strong style="color: navy" class="hl-tag">&lt;id&gt;</strong>add-source<strong style="color: navy" class="hl-tag">&lt;/id&gt;</strong>
            <strong style="color: navy" class="hl-tag">&lt;phase&gt;</strong>generate-sources<strong style="color: navy" class="hl-tag">&lt;/phase&gt;</strong>
            <strong style="color: navy" class="hl-tag">&lt;goals&gt;</strong>
                <strong style="color: navy" class="hl-tag">&lt;goal&gt;</strong>add-source<strong style="color: navy" class="hl-tag">&lt;/goal&gt;</strong>
            <strong style="color: navy" class="hl-tag">&lt;/goals&gt;</strong>
            <strong style="color: navy" class="hl-tag">&lt;configuration&gt;</strong>
                <strong style="color: navy" class="hl-tag">&lt;sources&gt;</strong>
                    <strong style="color: navy" class="hl-tag">&lt;source&gt;</strong>src/main/java<strong style="color: navy" class="hl-tag">&lt;/source&gt;</strong>
                    <strong style="color: navy" class="hl-tag">&lt;source&gt;</strong>target/mithra/generated/src/main/java<strong style="color: navy" class="hl-tag">&lt;/source&gt;</strong>
                <strong style="color: navy" class="hl-tag">&lt;/sources&gt;</strong>
            <strong style="color: navy" class="hl-tag">&lt;/configuration&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;/execution&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/executions&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/plugin&gt;</strong>
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40958"></a><a name="N40967"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is there a Maven plug-in to reverse-engineer Reladomo object XML files from an existing database schema?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>No. Use the Maven Antrun plugin instead.</p><p>For more details, see the <a class="ulink" href="http://maven.apache.org/plugins/maven-antrun-plugin/usage.html" target="_top">Maven AntRun</a> documentation.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N4097B"></a><a name="N4098D"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I work with Stored Procedures in Reladomo?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Short answer: You can't.</p><p>Long answer:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>Stored procedures are considered an anti-pattern.
                              They are not supported by Reladomo, and never will be.</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>When working with Stored Procedures, the core facilities of Reladomo
                              are no longer meaningful:</p>
                        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                                <p>Finders don't make sense</p>
                            </li><li class="listitem" style="list-style-type: 1">
                                <p>"transactional" could not be supported</p>
                            </li><li class="listitem" style="list-style-type: 1">
                                <p>Relationships become impossible (no deep fetch, no search)</p>
                            </li><li class="listitem" style="list-style-type: 1">
                                <p>Caching is mostly meaningless</p>
                            </li><li class="listitem" style="list-style-type: 1">
                                <p>Aggregation over is impossible</p>
                            </li></ul></div>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>There is no easy way to test a Stored Procedure</p>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>Stored procedures in Reladomo would introduce problems with the having
                            duplicate/inconsistent values of objects in memory.
                            Reladomo ensures that can&rsquo;t happen, but if this stored procedure is reading
                            some data that Reladomo has control over, there is a good chance for inconsistency.</p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N409DB"></a><a name="N409E7"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Why does setMaxObjectsToRetrieve() sometimes work, and sometimes doesn't?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>This isn&rsquo;t the first time this has come up.
                    We could make them consistent, but the point of setMaxObjectsToRetrieve is to reduce IO,
                    not artificially limit the length of the list.
                    Obviously, with a cache hit, there is no point in reducing IO.
                    The fact that you&rsquo;re noticing this implies you&rsquo;re retrieving this information anyway,
                    so why are you limiting it in one spot, but not the other?
                    Queries that use setMaxObjectsToRetrieve will not get cached,
                    so your inconsistent usage is actually hurting the cache performance.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N409F4"></a><a name="N40A03"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Can you bulk-insert to a table with nullable columns
                    if those columns are not mapped in Reladomo?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>For bulk insert, all columns must be mapped.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40A10"></a><a name="N40A1C"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Why can't we bulk-insert varchar columns bigger than 256?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The BCP protocol that bulk-insert is implemented upon is old,
                    and simply doesn't support varchar columns larger than 256.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40A29"></a><a name="N40A38"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What schema spaces can Reladomo use to create temporary tables?
                The runtime uses an application ID that is part of DACT_RW</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>By default Reladomo is configured to create temporary tables  in SESSION.
                    Your user ID must be granted create/drop table permissions for SESSION.</p><p>You can ask your DBA to give create table permission to DACT_RW on the SESSION schema
                    (One needs to grant creattab on database to dact_rw group;
                    createin, alterin, dropin schema permissions on SESSION schema to dact_rw group;
                    and use of user tablespace(s) to dact_rw group). </p><p>Or, you can create a schema for Reladomo&rsquo;s temporary usage,
                    with proper permissions similar to above.
                    You then have to create a subclass of Udb82DatabaseType that overrides all the methods
                    that deal with SESSION (getTableNameForNonSharedTempTable,
                    getSqlPrefixForNonSharedTempTableCreation, appendSharedTempTableCreatePreamble, createIndexSql).
                    Use your subclass in your connection manager.</p><p>Or, you can use a different schema (as of Reladomo 12.5.0) for temp tables by calling
                    Udb82DatabaseType.setTempSchemaName</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40A4E"></a><a name="N40A5D"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>I have multiple JVMs running Reladomo and accessing the same database, some reading,
                      some writing, and some doing both.  How do I keep the caches up-to-date?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Reladomo's TCP Notification Server is what you need, and easy to set up and try out.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                        <p>(a) Setup the notification server. It should be something like:
                        </p>
                        <pre class="programlisting">
java -classpath <strong style="color: navy" class="hl-tag">&lt;</strong> <span style="color: blue" class="hl-attribute">all_the_required_jars</span><strong style="color: navy" class="hl-tag"> &gt;</strong> -Dport=<strong style="color: navy" class="hl-tag">&lt;</strong> <span style="color: blue" class="hl-attribute">some_port_number</span><strong style="color: navy" class="hl-tag"> &gt;</strong> com.gs.fw.common.mithra.notification.server.NotificationServer
</pre>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>(b) In the processes that read or write Reladomo objects, configure them for notification:
                        </p>
                        <pre class="programlisting">
MithraManagerProvider.getMithraManager().setNotificationEventManager(
    new MithraNotificationEventManagerImpl(new TcpMessagingAdapterFactory(host, port)));
</pre>
                    </li><li class="listitem" style="list-style-type: 1">
                        <p>The host and port in (b) should point to where (a) is running</p>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40A88"></a><a name="N40A9A"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>I have set up a notification server -- how do I get transparency into what is happening?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Set the notification logging level to "DEBUG" on each of the VMs.</p><pre class="programlisting">
com.gs.fw.common.mithra.notification
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40AAB"></a><a name="N40AB7"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Where can I get training for Reladomo?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Look at all the documentation released with Reladomo.</p><p>Also take a look at the
                    Reladomo Kata
                    which is a combination of presentation material and hands-on exercises designed to get
                    you working with the Reladomo API. This is offered as a solo, self-paced course, or with notice,
                    can be given as a GSU-style training session to a group of developers at one-time.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40AC7"></a><a name="N40AD6"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I test if my deep-fetch is working?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>You need to verify that the number of calls you make to a DB are as many as you expect.</p><pre class="programlisting">
<em style="color: gray" class="hl-comment">// deep-fetch a list</em>
EmployeeList employees = EmployeeFinder.findMany(EmployeeFinder.all());
employees.deepFetch(EmployeeFinder.demographics());
employees.deepFetch(EmployeeFinder.personalInfo().addresses());
<em style="color: gray" class="hl-comment">// ensure the resulting list is resolved, e.g. by calling forceResolve()</em>
<em style="color: gray" class="hl-comment">// verify we got the expected number of employees</em>
assertEquals(<span style="color:blue" class="hl-number">15</span>, employees.size());
<em style="color: gray" class="hl-comment">// Now grab a count of DB retrieves so far:</em>
<strong class="hl-keyword"><span style="color: #000080">int</span></strong> count = MithraManagerProvider.getMithraManager().getDatabaseRetrieveCount();
<em style="color: gray" class="hl-comment">// do something interesting that exercises the list you fetched, e.g.</em>
<strong class="hl-keyword"><span style="color: #000080">int</span></strong> totalAddressCount = <span style="color:blue" class="hl-number">0</span>; <em style="color: gray" class="hl-comment">// (there's better ways of getting this, but this is just a made-up example)</em>
<strong class="hl-keyword"><span style="color: #000080">for</span></strong> (Employee employee : employees)
{
    totalAddressCount += employee.getAddresses().size();
}
<em style="color: gray" class="hl-comment">// if your deep-fetches were good, then there should not have been any additional retrieves made, so:</em>
assertEquals(count, MithraManagerProvider.getMithraManager().getDatabaseRetrieveCount());
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40AE7"></a><a name="N40AF3"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What connection manager should I use?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>You only have two choices:
                    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                            <p>XaConnectionManager that comes with Reladomo</p>
                        </li><li class="listitem" style="list-style-type: 1">
                            <p>Jolt + its connection manager</p>
                        </li></ul></div><p>
                    You must not use some random connection manager with Reladomo.
                </p><p>Here is how to use XaConnectionManager (which is far more advanced than the pool in jndi-jdbc):</p><pre class="programlisting">
connectionManager = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> XAConnectionManager();
connectionManager.setLdapName(ldapName);
connectionManager.setJdbcUser(user);
connectionManager.setJdbcPassword(password);
connectionManager.setDefaultSchemaName(schemaName);
connectionManager.setPoolName(ldapName + <strong class="hl-string"><span style="color: green">" connection pool"</span></strong>);
connectionManager.setInitialSize(<span style="color:blue" class="hl-number">1</span>);
connectionManager.setPoolSize(<span style="color:blue" class="hl-number">100</span>);
connectionManager.setUseStatementPooling(true);
connectionManager.setProperty(<strong class="hl-string"><span style="color: green">"com.gs.fw.aig.jdbc.global.DataSourceImpl"</span></strong>, <strong class="hl-string"><span style="color: green">"com.sybase.jdbc4.jdbc.SybDataSource"</span></strong>);
connectionManager.setProperty(<strong class="hl-string"><span style="color: green">"com.gs.fw.aig.jdbc.global.ConnectionPoolDataSourceImpl"</span></strong>, <strong class="hl-string"><span style="color: green">"com.sybase.jdbc4.jdbc.SybConnectionPoolDataSource"</span></strong>);
connectionManager.setProperty(<strong class="hl-string"><span style="color: green">"com.sybase.jdbc4.jdbc.SybDataSource.REPEAT_READ"</span></strong>, <strong class="hl-string"><span style="color: green">"false"</span></strong>);
connectionManager.initialisePool();
</pre><p>and your SourcelessConnection manager will hold that object and implement:</p><pre class="programlisting">
<strong class="hl-keyword"><span style="color: #000080">public</span></strong> Connection getConnection()
{
    <strong class="hl-keyword"><span style="color: #000080">return</span></strong> <strong class="hl-keyword"><span style="color: #000080">this</span></strong>.connectionManager.getConnection();
}
             </pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40B1E"></a><a name="N40B2A"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Is there a way that I can use Spring framework for transaction management?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>
                    Although this is relatively straight forward to do (by providing implementation of a
                    few Spring interfaces that delegate to Reladomo), we strongly recommend against this.
                </p><p>
                    Spring has no notion of full code re-execution on deadlock/timeout/optimistic
                    lock failure. That's a significant reliability concern for production applications.
                </p><p>
                    Transaction management with Reladomo is simple, flexible and industrial strength.
                    See the documentation for MithraManager.executeTransactionalCommand and the
                    TransactionStyle object.
                </p><p>
                    There is not a significant need to use an IoC container with anything that Reladomo needs.
                    For individual apps, that&rsquo;s really up to each app; however, don&rsquo;t mix the concerns of
                    transaction management with the rest of what IoC containers provide.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40B40"></a><a name="N40B4F"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I "restore" a previous version of a audit-only dated object?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>You need to assign the values of a old object to the current one,
                      or create a new one if there is no current instance:
                </p><pre class="programlisting">
Foo oldFoo = ... <em style="color: gray" class="hl-comment">// find it with processingDate().eq(restoreFromTime)</em>
Foo currentFoo = ... <em style="color: gray" class="hl-comment">// find it with [implicit] processingDate().eq(infinity)</em>
<strong class="hl-keyword"><span style="color: #000080">if</span></strong> (currentfoo == null)
{
    currentFoo = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> Foo();
    currentFoo.copyNonPrimaryKeyValuesFrom(oldFoo);
    currentFoo.setProcessingDateFrom(null);
    currentFoo.setProcessingDateTo(null);
    currentFoo.insert();
}
<strong class="hl-keyword"><span style="color: #000080">else</span></strong>
{
    currentFoo.copyNonPrimaryKeyValuesFrom(oldFoo);
}
             </pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40B60"></a><a name="N40B6F"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How do I perform a case-insensitive search of a column? Should I use wildCardEq()?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><pre class="programlisting">
<em style="color: gray" class="hl-comment">// Reladomo supports toLowerCase() and contains() on attributes:</em>
description().toLowerCase().contains(searchString.toLowerCase());

<em style="color: gray" class="hl-comment">// The following also works, but is less elegant:</em>
description().toLowerCase().wildCardEq(<strong class="hl-string"><span style="color: green">"*"</span></strong> + searchString.toLowerCase() + <strong class="hl-string"><span style="color: green">"*"</span></strong>);
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40B7D"></a><a name="N40B8F"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>I am using DB2 and performance seems poor, particularly of prepared statements,
                    and we don't think the indexes are being used. What's the problem?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>The basic configuration of DB2 makes some bad choices as its defaults, particularly around
                    optimization of prepared statements.
                    You may need the following lines in your connection manager configuration to tell DB2
                    to behave the right way:
                </p><pre class="programlisting">
<em style="color: gray" class="hl-comment">// Performance enhancement to tell DB2 to take distribution statistics into account</em>
<em style="color: gray" class="hl-comment">// for query parameters, and to re-optimize parameterized queries</em>
String REOPT_OPTION = <strong class="hl-string"><span style="color: green">"NULLIDR1"</span></strong>;
<strong class="hl-keyword"><span style="color: #000080">this</span></strong>.connectionManager.setProperty(<strong class="hl-string"><span style="color: green">"currentPackageSet"</span></strong>, REOPT_OPTION);
<strong class="hl-keyword"><span style="color: #000080">this</span></strong>.connectionManager.setProperty(<strong class="hl-string"><span style="color: green">"jdbcCollection"</span></strong>, REOPT_OPTION);
</pre><p>
                    You will also need to ensure that your DBAs have installed the "NULLIDR1" and "NULLIDRA"
                    packages on your DB2 instance.
                </p><p>
                    Note: If REOPT_OPTION = "NULLIDR1" doesn't work for you, try "NULLIDRA" instead.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40BA6"></a><a name="N40BB5"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Why does Reladomo use IntHashSet instead of Set&lt;Integer&gt;?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Primitives are far superior to boxed objects, e.g. int vs Integer.
                    Ideally, IntHashSet would be part of the JDK.
                </p><p>
                    Reladomo uses GS Collections IntHashSet because:
                    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: 1; "><li class="listitem" style="list-style-type: 1">
                            <p>The runtime performance is much better</p>
                        </li><li class="listitem" style="list-style-type: 1">
                            <p>IntSet has a much lower memory footprint than UnifiedSet&lt;Integer&gt;,
                                which is in turn much better than JDK's HashSet, and moreover,
                                has serious repercussions for cache coherency, locality and GC pauses
                            </p>
                        </li></ul></div><p>
                    Reladomo encourages usage of the efficient IntHashSet by providing the API to use it
                    with finder operations, e.g. in(IntHashSet), notIn(IntHashSet).
                    Reladomo discourages usage of the inefficient Set implementations by not providing
                    direct support in it's API for them.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40BD5"></a><a name="N40BE7"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Which repos can I get Reladomo from?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Maven central.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40BF4"></a><a name="N40C09"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I tell if Reladomo's queries match up to the indexes I have declared on my database tables?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>Use the Reladomo Index Reconciliation Tool: this tool verifies your XML is consistent and well-formed,
                    and validates Reladomo object dependencies. Additionally, it will verify that your DB tables and indexes
                    match what Reladomo expects.
                </p><p>Reladomo knows what attributes are used to define relationships between objects,
                    and hence can tell you what indices it needs to perform efficiently.
                </p><p>Class name is DatabaseIndexValidator.
                It has a main method with usage example.
                It can also be run as ant target. build.xml in Reladomo has ant target usage example:
                </p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;target</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"validate-mithra-db-indices-test"</span> <span style="color: blue" class="hl-attribute">depends</span>=<span style="color: green" class="hl-value">"compile-generate-mithra-xml"</span><strong style="color: navy" class="hl-tag">&gt;</strong>

    <strong style="color: navy" class="hl-tag">&lt;taskdef</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"mithra-validate-xml"</span>
            <span style="color: blue" class="hl-attribute">classname</span>=<span style="color: green" class="hl-value">"com.gs.fw.common.mithra.generator.objectxmlgenerator.DatabaseIndexValidator"</span>
            <span style="color: blue" class="hl-attribute">loaderRef</span>=<span style="color: green" class="hl-value">"indexValidator"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;classpath</strong> <span style="color: blue" class="hl-attribute">refid</span>=<span style="color: green" class="hl-value">"mithraxmlgen.classpath"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/taskdef&gt;</strong>

    <strong style="color: navy" class="hl-tag">&lt;mkdir</strong> <span style="color: blue" class="hl-attribute">dir</span> =<span style="color: green" class="hl-value">"${mithra.home}/build/mithra/tmp/generated"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>

    <strong style="color: navy" class="hl-tag">&lt;mithra-validate-xml</strong> <span style="color: blue" class="hl-attribute">userName</span>=<span style="color: green" class="hl-value">"username"</span> <span style="color: blue" class="hl-attribute">password</span>=<span style="color: green" class="hl-value">"password"</span> <span style="color: blue" class="hl-attribute">databaseType</span>=<span style="color: green" class="hl-value">"sybase"</span>
            <span style="color: blue" class="hl-attribute">xml</span>=<span style="color: green" class="hl-value">"${mithra.home}/xml/mithra/test/maxlengenerator/TestClassList.xml"</span>
            <span style="color: blue" class="hl-attribute">driver</span>=<span style="color: green" class="hl-value">"com.sybase.jdbc4.jdbc.SybDriver"</span>
            <span style="color: blue" class="hl-attribute">url</span>=<span style="color: green" class="hl-value">"jdbc:sybase:Tds:host:port/schema"</span>
            <span style="color: blue" class="hl-attribute">schema</span>=<span style="color: green" class="hl-value">"some_schema"</span><strong style="color: navy" class="hl-tag"> /&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/target&gt;</strong>
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40C20"></a><a name="N40C32"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>How can I verify if the Reladomo xmls which I wrote match up the database table definitions?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>There are 4 utilities which can be used. These utilities verify if your XML is consistent and well-formed, and validates Reladomo object dependencies.
                </p><p>All the classes viz. DatabaseTableValidator, DatabaseIndexValidator, MaxLenValidator, NullableColumnValidator have a main method with usage example.
                    These can also be run as ant target. The build.xml in Reladomo has ant target usage example.
                </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
                        <p>DatabaseTableValidator: This is used to verify the database columns and their data types.</p>
                        <pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;target</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"validate-mithra-xml-test"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;taskdef</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"mithra-validate-xml"</span> <span style="color: blue" class="hl-attribute">classname</span>=<span style="color: green" class="hl-value">"com.gs.fw.common.mithra.generator.objectxmlgenerator.DatabaseTableValidator"</span> <span style="color: blue" class="hl-attribute">loaderRef</span>=<span style="color: green" class="hl-value">"mithraXmlGenerator"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;classpath</strong> <span style="color: blue" class="hl-attribute">refid</span>=<span style="color: green" class="hl-value">"mithraxmlgen.classpath"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/taskdef&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mkdir</strong> <span style="color: blue" class="hl-attribute">dir</span> =<span style="color: green" class="hl-value">"${mithra.home}/build/mithra/tmp/generated"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mithra-validate-xml</strong> <span style="color: blue" class="hl-attribute">userName</span>=<span style="color: green" class="hl-value">"username"</span> <span style="color: blue" class="hl-attribute">password</span>=<span style="color: green" class="hl-value">"password"</span> <span style="color: blue" class="hl-attribute">databaseType</span>=<span style="color: green" class="hl-value">"sybase"</span>
            <span style="color: blue" class="hl-attribute">xml</span>=<span style="color: green" class="hl-value">"${mithra.home}/xml/mithra/test/maxlengenerator/TestClassList.xml"</span>
            <span style="color: blue" class="hl-attribute">driver</span>=<span style="color: green" class="hl-value">"com.sybase.jdbc4.jdbc.SybDriver"</span>
            <span style="color: blue" class="hl-attribute">url</span>=<span style="color: green" class="hl-value">"jdbc:sybase:Tds:host:port/schema"</span>
            <span style="color: blue" class="hl-attribute">schema</span>=<span style="color: green" class="hl-value">"some_schema"</span><strong style="color: navy" class="hl-tag"> /&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/target&gt;</strong>
</pre>
                    </li><li class="listitem">
                        <p>DatabaseIndexValidator: This is used to verify the defined indices.</p>
                        <pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;target</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"validate-mithra-xml-test"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;taskdef</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"mithra-validate-xml"</span> <span style="color: blue" class="hl-attribute">classname</span>=<span style="color: green" class="hl-value">"com.gs.fw.common.mithra.generator.objectxmlgenerator.DatabaseIndexValidator"</span> <span style="color: blue" class="hl-attribute">loaderRef</span>=<span style="color: green" class="hl-value">"indexValidator"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;classpath</strong> <span style="color: blue" class="hl-attribute">refid</span>=<span style="color: green" class="hl-value">"mithraxmlgen.classpath"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/taskdef&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mkdir</strong> <span style="color: blue" class="hl-attribute">dir</span> =<span style="color: green" class="hl-value">"${mithra.home}/build/mithra/tmp/generated"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mithra-validate-xml</strong>
        <span style="color: blue" class="hl-attribute">userName</span>=<span style="color: green" class="hl-value">"userName"</span>
        <span style="color: blue" class="hl-attribute">password</span>=<span style="color: green" class="hl-value">"pass"</span>
        <span style="color: blue" class="hl-attribute">databaseType</span>=<span style="color: green" class="hl-value">"sybase"</span>
        <span style="color: blue" class="hl-attribute">xml</span>=<span style="color: green" class="hl-value">"${mithra.home}/xml/mithra/test/maxlengenerator/TestClassList.xml"</span>
        <span style="color: blue" class="hl-attribute">driver</span>=<span style="color: green" class="hl-value">"com.sybase.jdbc4.jdbc.SybDriver"</span>
        <span style="color: blue" class="hl-attribute">url</span>=<span style="color: green" class="hl-value">"jdbc:sybase:Tds:hostname.example.com:5000/mithra_qa/mithra_qa"</span> <span style="color: blue" class="hl-attribute">schema</span>=<span style="color: green" class="hl-value">"mithra_qa"</span><strong style="color: navy" class="hl-tag"> /&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/target&gt;</strong>
</pre>
                    </li><li class="listitem">
                        <p>MaxLenValidator: This is used to verify the defined maxLength attribute of String columns.</p>
                        <pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;target</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"validate-mithra-xml-test"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;taskdef</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"mithra-validate-xml"</span> <span style="color: blue" class="hl-attribute">classname</span>=<span style="color: green" class="hl-value">"com.gs.fw.common.mithra.generator.objectxmlgenerator.MaxLenValidator"</span> <span style="color: blue" class="hl-attribute">loaderRef</span>=<span style="color: green" class="hl-value">"mithraXmlGenerator"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;classpath</strong> <span style="color: blue" class="hl-attribute">refid</span>=<span style="color: green" class="hl-value">"mithraxmlgen.classpath"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/taskdef&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mkdir</strong> <span style="color: blue" class="hl-attribute">dir</span> =<span style="color: green" class="hl-value">"${mithra.home}/build/mithra/tmp/generated"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mithra-validate-xml</strong> <span style="color: blue" class="hl-attribute">userName</span>=<span style="color: green" class="hl-value">"username"</span> <span style="color: blue" class="hl-attribute">password</span>=<span style="color: green" class="hl-value">"password"</span> <span style="color: blue" class="hl-attribute">databaseType</span>=<span style="color: green" class="hl-value">"sybase"</span>
            <span style="color: blue" class="hl-attribute">xml</span>=<span style="color: green" class="hl-value">"${mithra.home}/xml/mithra/test/maxlengenerator/TestClassList.xml"</span>
            <span style="color: blue" class="hl-attribute">driver</span>=<span style="color: green" class="hl-value">"com.sybase.jdbc4.jdbc.SybDriver"</span>
            <span style="color: blue" class="hl-attribute">url</span>=<span style="color: green" class="hl-value">"jdbc:sybase:Tds:host:port/schema"</span>
            <span style="color: blue" class="hl-attribute">schema</span>=<span style="color: green" class="hl-value">"some_schema"</span><strong style="color: navy" class="hl-tag"> /&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/target&gt;</strong>
</pre>
                    </li><li class="listitem">
                        <p>NullableColumnValidator: This is used to verify if the columns are defined as nullable or non-nullable correctly.</p>
                        <pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;target</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"validate-mithra-xml-test"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;taskdef</strong> <span style="color: blue" class="hl-attribute">name</span>=<span style="color: green" class="hl-value">"mithra-validate-xml"</span> <span style="color: blue" class="hl-attribute">classname</span>=<span style="color: green" class="hl-value">"com.gs.fw.common.mithra.generator.objectxmlgenerator.NullableColumnValidator"</span> <span style="color: blue" class="hl-attribute">loaderRef</span>=<span style="color: green" class="hl-value">"mithraXmlGenerator"</span><strong style="color: navy" class="hl-tag">&gt;</strong>
        <strong style="color: navy" class="hl-tag">&lt;classpath</strong> <span style="color: blue" class="hl-attribute">refid</span>=<span style="color: green" class="hl-value">"mithraxmlgen.classpath"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;/taskdef&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mkdir</strong> <span style="color: blue" class="hl-attribute">dir</span> =<span style="color: green" class="hl-value">"${mithra.home}/build/mithra/tmp/generated"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
    <strong style="color: navy" class="hl-tag">&lt;mithra-validate-xml</strong> <span style="color: blue" class="hl-attribute">userName</span>=<span style="color: green" class="hl-value">"username"</span> <span style="color: blue" class="hl-attribute">password</span>=<span style="color: green" class="hl-value">"password"</span> <span style="color: blue" class="hl-attribute">databaseType</span>=<span style="color: green" class="hl-value">"sybase"</span>
            <span style="color: blue" class="hl-attribute">xml</span>=<span style="color: green" class="hl-value">"${mithra.home}/xml/mithra/test/maxlengenerator/TestClassList.xml"</span>
            <span style="color: blue" class="hl-attribute">driver</span>=<span style="color: green" class="hl-value">"com.sybase.jdbc4.jdbc.SybDriver"</span>
            <span style="color: blue" class="hl-attribute">url</span>=<span style="color: green" class="hl-value">"jdbc:sybase:Tds:host:port/schema"</span>
            <span style="color: blue" class="hl-attribute">schema</span>=<span style="color: green" class="hl-value">"some_schema"</span><strong style="color: navy" class="hl-tag"> /&gt;</strong>
<strong style="color: navy" class="hl-tag">&lt;/target&gt;</strong>
</pre>
                    </li></ul></div></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40C6D"></a><a name="N40C7F"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What's the best way to update a set of existing data based on a new incoming set of detached data?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>First, you should avoid using List's contains/remove methods -- they require an equals contract,
                    but it is usually not the best solution. Also, updating large (e.g. &gt; 100) lists of data
                    will be slow, as it's multiple O(n^2) loops.
                </p><p>The best practice is to use a FullUniqueIndex on your current/existing data to optimize access
                    to help you create a delta. Something like the following:
                </p><pre class="programlisting">
FullUniqueIndex index = <strong class="hl-keyword"><span style="color: #000080">new</span></strong> FullUniqueIndex(<strong class="hl-string"><span style="color: green">""</span></strong>, ProductFinder.getPrimaryKeyAttributes());
index.addAll(fileProducts);
<strong class="hl-keyword"><span style="color: #000080">for</span></strong> (<strong class="hl-keyword"><span style="color: #000080">int</span></strong> i = detachedDbProducts.size() - <span style="color:blue" class="hl-number">1</span>; i &gt;= <span style="color:blue" class="hl-number">0</span>; i--)
{
    Product detachedDbProduct = detachedDbProducts.get(i);
    Product fileProduct = index.remove(detachedDbProduct);
    <strong class="hl-keyword"><span style="color: #000080">if</span></strong> (fileProduct == null)
    {
        <em style="color: gray" class="hl-comment">// Removed item</em>
        detachedDbProducts.remove(i);
    }
    <strong class="hl-keyword"><span style="color: #000080">else</span></strong>
    {
        <em style="color: gray" class="hl-comment">// Updated item -- typically this would be an update, e.g.</em>
        detachedDbProduct.copyNonPrimaryKeyValuesFrom(fileProduct);
    }
}
<em style="color: gray" class="hl-comment">// New items (i.e. anything remaining in the index after the loop has finished)</em>
detachedDbProducts.addAll(index.getAll());
...
detachedDbProducts.copyDetachedValuesToOriginalOrInsertIfNewOrDeleteIfRemoved();
</pre><p>
                    For larger amounts of data, the multi-threaded loader (mtloader) / matcher thread is the way to go.
                </p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40C96"></a><a name="N40CA2"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Does Reladomo support result-set paging?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>No. Not all database systems support pagination (notably Sybase and DB2).</p><p>The best we can do right now is limit the results fetched using <code class="code">setMaxObjectsToRetrieve()</code></p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40CB4"></a><a name="N40CC0"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Does Reladomo support Views?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>More or less. You are able to map a View to a Reladomo object, since from a SQL technical
                    perspective a View is very similar to a Table, however it's behaviour is not guaranteed,
                    especially with updates or when the underlying tables are mapped to other Reladomo objects.</p><p>In general, Views are an anti-pattern when using an ORM system, like Reladomo.
                    They also tend to perform very poorly.</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40CD0"></a><a name="N40CDC"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Text fields / How can I store long text values using Reladomo?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>In your DB schema, use "text" (or equivalent) as the column type,
                    and in your Reladomo Object XML use javaType="String".</p></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40CE9"></a><a name="N40CFB"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>Do I have any control for clearing objects that Reladomo has cached?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>First, ask yourself why you need or _think_ you need to clear the cache
                    -- quite often what you really need is your Reladomo-based app to work in
                    a friendly way with other Reladomo-based apps. In this case, you
                    should investigate Reladomo "Notification", which is a powerful
                    and efficient way of managing cache coherency across multiple JVM instances.</p><p>The programmatic way to clear all cache entries in the JVM is:</p><pre class="programlisting">
MithraManager.getInstance().clearAllQueryCaches()
</pre><p>You can clear the cache on an individual finder with:</p><pre class="programlisting">
FooFinder.clearQueryCache()
</pre><p>You can also set timeouts for caches on a per-object basis in the runtime XML.
                    If you choose a decent timeout (several minutes),
                    then you get most of the benefit of caching without having to worry about clearing it.
                    For example, a 2 minute timeout:
                </p><pre class="programlisting">
<strong style="color: navy" class="hl-tag">&lt;MithraObjectConfiguration</strong> <span style="color: blue" class="hl-attribute">className</span>=<span style="color: green" class="hl-value">"com.gs.fw.common.mithra.test.domain.OrderItemWi"</span>
    <span style="color: blue" class="hl-attribute">cacheType</span>=<span style="color: green" class="hl-value">"partial"</span>
    <span style="color: blue" class="hl-attribute">relationshipCacheTimeToLive</span>=<span style="color: green" class="hl-value">"120000"</span>
    <span style="color: blue" class="hl-attribute">cacheTimeToLive</span>=<span style="color: green" class="hl-value">"120000"</span><strong style="color: navy" class="hl-tag">/&gt;</strong>
</pre></td></tr>
        
            
            <tr class="question"><td valign="top" align="left"><a name="N40D1D"></a><a name="N40D32"></a><p><b>Q:</b></p></td><td valign="top" align="left"><p>What's the difference between <code class="code">delete()</code>, <code class="code">terminate()</code>, and <code class="code">purge()</code>?</p></td></tr>
            <tr class="answer"><td valign="top" align="left"><p><b>A:</b></p></td><td valign="top" align="left"><p>All the methods are used for removing an object, but are used in different contexts and different actions:
                    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
                            <p>
                                <span class="bold"><strong><code class="code">delete()</code></strong></span>
                                is used when the object is not dated (i.e. does not have an AsOfAttribute),
                                and removes the data entirely from the DB.
                            </p>
                        </li><li class="listitem">
                            <p>
                                <span class="bold"><strong><code class="code">terminate()</code></strong></span>
                                is used when an object is dated, and will "chain out" a record,
                                meaning that it will no longer be visible to queries as-of "now",
                                but it&rsquo;s history is still available and it can be queried "as-of".
                            </p>
                        </li><li class="listitem">
                            <p>
                                <span class="bold"><strong><code class="code">purge()</code></strong></span>
                                is used when you are saying I don&rsquo;t want that history any more (and for most
                                of our systems, it means it must be archived off someplace else beforehand
                                -- hence, caution is required when using this method).
                            </p>
                        </li></ul></div><p>
                    The short of it is that delete() or terminate() is usually what you want, and if you feel
                    the need to use purge() you should check with your team-lead and a Reladomo expert first
                    to ensure it&rsquo;s being used appropriately and correctly.
                </p></td></tr>
        </tbody></table></div>
</div></body></html>